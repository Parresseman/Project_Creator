<html>
<head>
  <title>Project Creator</title>
  <meta http-equiv="x-ua-compatible" content="ie=9">
  <hta:application 
     id="PCreator"
     applicationname="ProjectCreator"
     version="1"
  </hta>
</head>
<style>
html,body {
	font-size: 15px; 
	font-family:calibri;
	
}

body {
	margin-left: 20px;
	margin-right: 20px; 

}

select {
	height: 20px;
	border-radius: 2px;
	border: 1px solid #ededed;
}

h1,h2 {
	color: #FF5A10;
	font-size: 24px;

}

.bouton  {
	padding: 10px 10px;
	border-radius: 2px;
	border-style: none;
}
	
.bouton:hover {
	color: #FFFFFF;
	background-color: #FF5A10;
}

#bouton {
	margin-top: 20px;

}

label {
	margin-right: 5px;


}

i {
	color: #FF5A10;


}

#myProgress {
	border-radius: 3px;
	margin-top: 10px;
    width: 100%;
    background-color: #f9f9f9;
	
}
#myBar {
	border-radius: 3px;
    width: 0%;
    height: 30px;
    background-color: #FF5A10;
	text-align: center;
	color: white;
	line-height: 30px;
	white-space: nowrap;
}


</style>
<body onload="window.resizeTo(470,400)">
	<h1>
		Project Creator:
	</h1>
	<div>
		<label for="Folder">Project name:</label>
		<input id="Folder" type="text" name="Create_Folder">
	</div>
	<div id="bouton">
		<button class="bouton" type="button" onclick="folder_create()">
			Create project
		</button>
		<button class="bouton" type="button" onclick="test()">
			Test
		</button>
	</div>
	<div id="myProgress">
		<div id="myBar">
		</div>
	</div>
	<div id="instruction">
		<h2>Proc&#233;dure:</h2>
		<ul>
			<li>Placer le fichier .hta &#224; l&#39;endroit o&#249; vous souhaitez </br>cr&#233;er votre projet</li>
			<li>Entrez le nom du projet dans le champs <i>Project name</i></li>
			<li>Cliquez sur <i>Create project</i></li>
			<li>Et voil&#224; votre projet est cr&#233;&#233; !</li>
		</ul>
	</div>
	<script language="JavaScript" type="text/javascript">
		ActiveX = new ActiveXObject("Scripting.FileSystemObject");
		
		function test() {
			alert("null");
		}
		
		
		function folder_create() {
			var path = document.getElementById("Folder").value;
			if (ActiveX.FolderExists(path)) {
			
			alert("Folder already exist !");
			
			} else if (path==""){
			
			alert("Insert a project name !");
			
			} else {
			var id = setInterval(frame, 10);
			var elem = document.getElementById("myBar");
			var width = 10;
			var val = [
				function() { ActiveX.CreateFolder(".\\"+ path +"\\") }, 
				function() { ActiveX.CreateTextFile(".\\"+ path +"\\Readme.txt",false) }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\01_Pre_Prod\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\02_Prod\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\03_Post_Prod\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\01_Pre_Prod\\01_Script\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\01_Pre_Prod\\02_VoiceActing\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\01_Pre_Prod\\03_Storyboard\\") },
				function() { ActiveX.CreateFolder(".\\"+ path +"\\01_Pre_Prod\\04_Animatique\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\01_Pre_Prod\\05_BG_Layout\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\01_Pre_Prod\\06_Render\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\02_Prod\\01_Animation_Clean\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\02_Prod\\02_BG_Clean\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\02_Prod\\02_BG_coloring\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\02_Prod\\03_Render\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\03_Post_Prod\\01_Animation_Ink\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\03_Post_Prod\\02_Compositing\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\03_Post_Prod\\03_Render\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\03_Post_Prod\\04_SoundFX\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\03_Post_Prod\\05_Editing\\") }, 
				function() { ActiveX.CreateFolder(".\\"+ path +"\\03_Post_Prod\\06_Output_EXp\\") } 
			];			
			var i = 0;
			function frame() {
				if (width >= 100) {
					width = 100;
					elem.style.width = width + '%';
					elem.innerHTML = width * 1 + '%';				
					clearInterval(id);
				} else if (i < 21) {
					val[i]();
					width++;
					elem.style.width = width + '%';
					elem.innerHTML = width * 1 + '%';
					i++;				
				
				} else {
					width = 100;
					elem.style.width = width + '%';
					elem.innerHTML = width * 1 + '%';					
				
				}
				
			}
	
			}				
		}
	</script>
</body>
</html>
